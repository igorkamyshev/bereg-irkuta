language: node_js
sudo: required
services:
- docker
node_js:
- '10'
script: npm run ci
before_deploy:	
- docker pull "$DOCKER_USERNAME"/"$IMAGE_NAME" || true	
- docker build --pull --cache-from "$IMAGE_NAME" --tag "$IMAGE_NAME" .	
- docker login -u "$DOCKER_USERNAME" -p "$DOCKER_PASSWORD"	
- docker tag "$IMAGE_NAME" "$DOCKER_USERNAME/${IMAGE_NAME}:latest"	
- docker push "$DOCKER_USERNAME/${IMAGE_NAME}:latest"